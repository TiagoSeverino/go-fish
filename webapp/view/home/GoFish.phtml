<?php
use ArmoredCore\WebObjects\Asset;
use ArmoredCore\WebObjects\Layout;
use ArmoredCore\WebObjects\URL;
use ArmoredCore\WebObjects\Data;
$game = Data::get('game');

Layout::includeLayout('header');
?>

<ul>
    <li>
        <a href="<?=Url::toRoute('home/Reset')?>">Reset</a>
    </li>
    <li style="display: inline">
        Player Score: <?= $game->getPlayerPoints() ?>
    </li>
    <li style="display: inline">
        Is Finished: <?= $game->isFinished() ? 'true' : 'false' ?>
    </li>
    <li style="display: inline; float: right;">
        Bot Score: <?= $game->getBotPoints() ?>
    </li>
    <div class="row"></div>
    <li>
        Player Hand:
        <ul>
            <?php foreach ($game->getPlayerHand() as $card) { ?>
                <div class="col-md-1 col-xs-3">
                    <!-- <li style="display: inline"> <?= $card->getIdentifier() ?> </li> -->
                    <img src="<?=Asset::image('Cards/card' . $card->getIdentifier() . '.png')?>" class="card" id="<?= $card->getIdentifier() ?>">
                </div>
            <?php } ?>
        </ul>
    </li>
    <div class="row"></div>
    <li>
        Bot Hand:
        <ul>
            <?php foreach ($game->getBotHand() as $card) { ?>
                <div class="col-md-1 col-xs-3">
                    <!-- <li style="display: inline"> <?= $card->getIdentifier() ?> </li> -->
                    <img src="<?=Asset::image( $game->isDebug() ? 'Cards/card' . $card->getIdentifier() . '.png' : 'Cards/cardBack_red4.png' )?>" class="" id="<?= $card->getIdentifier() ?>">
                </div>
            <?php } ?>
        </ul>
    </li>
    <div class="row"></div>
    <li>
        Deck:
        <ul>
            <?php foreach ($game->getDeck() as $card) { ?>
                <div class="col-md-1 col-xs-3">
                    <!-- <li style="display: inline"> <?= $card->getIdentifier() ?> </li> -->
                    <img src="<?=Asset::image( $game->isDebug() ? 'Cards/card' . $card->getIdentifier() . '.png' : 'Cards/cardBack_red4.png' )?>" class="" id="<?= $card->getIdentifier() ?>">
                </div>
            <?php } ?>
        </ul>
    </li>
</ul>

<script>
    $( document ).ready(function() {
        let canPlay = true;

        $('.card').click(function(){
            if (canPlay == false){
                return;
            }
            canPlay = false;
            //alert($(this).attr('id'));

            $.ajax({
                type: "POST",
                url: "GoFish",
                data: {
                    card:$(this).attr('id')//.replace(/\D/g,'')
                },
                success: function(data) {  
                    <?= $game->isDebug() ? 'alert(data);' : ''?>
                    location.reload();  
                }
            });
        });
    });
</script>


<?php
Layout::includeLayout('footer')
?>
